{# vim:tabstop=2:expandtab #}
{% extends "layout_bootstrap.html" %}
{% block search %}
<div class=body>
	{% include "member_header.html" %}
	<div class="container"> {# outer container #}
	<h3>Access</h3>
	<form action="{{ url_for('members.member_setaccess',id=rec.id) }}" method="post">
	  <table class="table table-sm">
		<tr>
		  <th>Resource</th>
		  <th>Description</th>
		  <th>Contact</th>
		  <th>Allowed</th>
		  <th>Permissions</th>
		</tr>
		{% for a in access %}
		  <tr>
			<td>{{ a.resource.name }}</td>
			<td>{{ a.resource.description }}</td>
			<td>{{ a.resource.owneremail }}</td>
			<td>
				{% if a.myPerms >= 1 %}
				<input type="checkbox" 
					name="access_{{ a.resource.name }}" {{ 'checked' if (a.active == 1) else '' }} 
				/>
				<input type="hidden" 
					name="orgaccess_{{ a.resource.name }}" value="{{ 'on' if (a.active == 1) else 'off' }}"
				/>
				{% else %}
				{{ '&#10004;'|safe  if (a.active == 1) else '' }} 
				{% endif %}
			</td>			
			{% if a.myPerms >= 2 %}
			<td>
			<select name="privs_{{ a.resource.name }}">
				<option name="User" value="0" 
				{{ 'selected' if (a.level == 0) else '' }}
				/>User</option>

				<option name="Trainer" value="1" 
				{{ 'selected' if (a.level == 1) else '' }}
			  	{{ 'disabled' if (a.myPerms <= 1) else '' }}
				/>Trainer</option>

				<option name="ARM" value="2" 
				{{ 'selected' if (a.level == 2) else '' }}
			  	{{ 'disabled' if (a.myPerms <= 2) else '' }}
				/>Ass't RM</option>

				<option name="RM" value="3" 
				{{ 'selected' if (a.level == 3) else '' }}
			  	{{ 'disabled' if (a.myPerms <= 3) else '' }}
				/>RM</option>
			</select>
			</td>
			{% else %}
			<td>{{ a.levelText }}</td>
			{% endif %}
		  </tr>
	    {% endfor %}
	  </table>
	 {% if current_user.privs("Admin") %}
	 <hr />
	 <h3>Assigned Roles</h3>
	 <div class="container">
		{% for r in roles %}
			<div class="form-row">
				<div class="form-col col-sm-1">
					<input type="checkbox" id="role_{{ r.name }}" name="role_{{ r.name }}" {{ 'checked' if (r.id) else '' }} />
				</div>
					<label class="col-md-2 col-form-label" for="role_{{ r.name }}">{{ r.name }}</label>
					<input type="hidden" name="orgrole_{{ r.name }}" value="{{ 'on' if (r.id) else 'off' }}" />
			</div>
		{% endfor %}
	 </div>
	 <hr />
	 {% endif %}

	 {% if current_user.privs("Useredit") %}
	 <h3>Change Password</h3>
	 <div class="container">
		 <div class="row">
			<div class="col-sm-2">
				 Password:
			</div>
			<div class="col-sm-4">
				<input type="password" name="password1" value="" size=20 />
			</div>
		</div>
		 <div class="row">
			<div class="col-sm-2">
				 Reenter:
			</div>
			<div class="col-sm-4">
				 <input type="password" name="password2" value="" size=20 />
			</div>
		</div>
	 </div>
	 {% endif %}
  {% if allowsave %}
	<input type=submit value="Save Changes"/>
  {% endif %}
	 <hr />
	</form>
	</div> {# Outer  contrainer #}
</div> {# Body base contrainer #}
{% endblock %}
